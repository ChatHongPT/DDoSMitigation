# Scripting_Guide

zeek는 이벤트기반 스크립팅 언어를 지원한다. <br>
zeek에서 생성된 모든 로그는 실제 zeek 스크립트에 의해 생성되고 있다. <br>

## 스크립트 문법

기본 변수선언

~~~zeek
# 이것은 주석 이다.

# 키워드 변수명: 타입 = 식;

# 키워드명
# global, local, const

# 배열 다루는 방법은 다양하다.
local my_list = ["abc", "def", "ghi"]; # 배열 선언시 ':' 생략 가능

# vector 사용법
local my_list = vector(1, 2, 3, 4); # 초기화시 입력한 값에 따라 타입이 자동으로 지정된다.
local my_list2: vector of count;

my_list2 += 3; # vector는 이런 식으로 배열 요소를 추가할 수 있다.
my_list2 += 64;
my_list2 += 23;

print my_list2[0] # 배열 접근은 이렇게 하면 된다.

# set 사용법
local my_list: set[string] = {"abc", "def", "ghi"};

local my_list2 = set( 23/tcp, 80/tcp, 143/tcp, 25/tcp ); # 초기화시 입력한 값에 따라 타입이 자동으로 지정된다.

add my_list["jkl"]; # 배열 요소 추가 시 사용된다.
add mylist2[443/tcp];

# table 사용법
local my_list5: table[string] of string # table[타입1, 타입2, 타입3, ...] of 저장할 데이터 타입;

my_list5["cat"] = "meow!";
my_list5["dog"] = "bow! wow!!";

local my_list5: table[string, string, int] of string;

my_list5["man", "south_korea", 21] = "hong guil dong";
my_list5["woman", "south_america", 23] = "kate";

~~~
타입 목록

|타입명|의미|예시|
|:----:|:----:|:----:|
|bool|참/거짓|true, false|
|int|정수|1234, -1234|
|count|양의 정수|1234|
|double|부동 소수점 숫자|123.456|
|time|시간 값| |
|interval|시간 간격| |
|string|문자열|"1234"|
|pattern|정규 표현식| |
|port|포트 번호|443/tcp|
|addr|IP 주소|192.168.0.1|
|subnet|서브넷 주소|192.168.0.1/24|
|enum|열거형 타입| |
|table|키-값 쌍의 집합|my_table["man", "south_korea", 21] = "hong guil dong";|
|set|값의 집합|my_set["index"]|
|vector|순서가 있는 값의 집합|my_vector[2]|
|record|구조체 타입| |
|function|함수 타입| |
|event|이벤트 타입| |
|hook|훅 타입| |
|file|파일 타입| |
|opaque|불투명 타입| |
|any|모든 타입을 포함하는 타입| |

출력

~~~zeek
print fmt("Hello World!"); # C 언어의 printf와 사용법이 유사하다. (%d, %s, %lf 지원)

print 출력할 변수; # Python 2.X 버전의 print 사용법과 유사하다.

print "이렇게도", "출력할 수 있습니다.", 변수명;


~~~

fmt 서식 지정자

|서식 지정자|의미|
|:--:|:------:|
|%d|정수형 변수|
|%f|실수형 변수|
|%s|문자열 변수|
|%b|부울린 변수|
|%t|시간 변수|
|%p|포트 변수|
|%h|호스트 변수|
|%n|네트워크 변수|

조건문
~~~
if(조건식){
  실행문;
}
else{
  실행문;
}
~~~


반복문
~~~
for(초기화, 초기화1, 초기화2... in 문자열 또는 배열){
  실행문;
}

for(초기화 in 1 | 5){
  실행문;
}

while(조건식){
  실행문;
}

Python의 반복문과 사용법이 유사하다.
~~~
